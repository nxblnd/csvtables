# CSVTables

## О программе

Программа читает CSV-файл с таблицей из чисел и формул вида 

```
= ARG1 OP ARG2
```
где `ARG1` и `ARG2` --- целые числа или адвеса ячеек в формате `Column_name` `Row_name`, 
а `OP` --- арифметическая операция из списка: `+`, `-`, `*`, `/`. 
Заголовок таблицы представлен первой строкой, в которой первое поле --- пустое,
строки нумеруются целыми положительными числами, не обязательно в порядке возрастания.

### Вычисление деления

Деление на 0 является ошибочной ситуацией. 
Деление числа на число даст в результате целую часть от полученного числа.

### Дополнительно о таблице

* Программа не возражает против наличия пустых ячеек если они не используются.
* Попытка выполнить действие над пустой ячейкой выдаст ошибку.
* Все ряды таблицы должны иметь одинаковое число столбцов.
* Формулы вычисляются, только если первый символ ячейки `=` (аналогичное поведение имеет LibreOffice Calc 6). 

### Входной файл

Входной файл передаётся первым аргументом командной строки:

```shell
$ csvtables filename.csv
```

### Вывод

Вывод корректно обработанной таблицы осуществляется в `stdout`, а ошибок --- в `stderr`.

Нормальное завершение программы так же оканчивается кодом возврата 0, ошибочное --- 1.

## Сборка программы

Для сборки необходим `CMake` версии >3.0 и компилятор C++ с поддержкой стандарта `C++11`.

Сборка выполнятеся командой

```shell
$ cmake . && cmake --build .
```

## Примеры работы

### Пример 1 
#### input
```
,A,B,Cell
1,1,0,1
2,2,=A1+Cell30,0
30,0,=B1+A1,5
```
#### output
```
,A,B,Cell
1,1,0,1
2,2,6,0
30,0,1,5
```

### Пример 2
#### input
```
,A,B,Cell
1,1,0,1
30,0,=B1+A1,5
2,2,=A1+Cell30,0
``` 
#### output
```
,A,B,Cell
1,1,0,1
30,0,1,5
2,2,6,0
```

### Пример 3
#### input
``` 
, A
1,= 5 + 5 
```
#### output
```
, A
1,10
```

### Пример 4
#### input
```
, A
1, = 5 + 5 
```
#### output
```
, A
1, = 5 + 5 
```

### Пример 5
#### input
```
```
(пустой файл)
#### output
```
```
(пустой вывод)

### Пример 6
#### input
```
,A,B,Cell
1,1,0,1
2,2,=A1+Cell100500,0
30,0,=B1+A1,5
```
#### output
```
Error occurred: Reference to non-existing row
```

### Пример 7
#### input
```
,A,B,Cell
1,1,0,1
2,2,=ZZZ1+Cell30,0
30,0,=B1+A1,5
```
#### output
```
Error occurred: Reference to non-existing column
```

### Пример 8
#### input
```
,A
1,=A1+0
```
#### output
``` 
Error occurred: Cyclic formulas detected
```

### Пример 9
#### input
```
,A
1,1
2,1,2
```
#### output
```
Error occurred: Not all rows have same size
```

### Пример 10
#### input
```
,A
1,1
2,=A1A1 + B2B2
```
#### output
```
Error occurred: Formula "=A1A1 + B2B2" is invalid
``` 